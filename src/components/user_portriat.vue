<template>
  <div style="height:98%;width:100%">
    <div ref="sexDom" style="width:100%; height:20%;"></div>
    <div ref="habitDom" style="width:100%; height:80%;"></div>
  </div>
</template>
<script>

export default {
  name: "userPortriat",
  props: ["userData", "isLunbo", "lbTime"],
  data() {
    return {
      sexChart: null, // 性别
      habitChart: null, // 兴趣
      indexItem: 0,
      timer: null, //  定时任务初始化
      habitData: null
    };
  },
  watch: {
    userData() {
      this.hasData();
    },
    isLunbo() {
      this.showTip();
      this.startAction();
    }
  },
  methods: {
    hasData() {
      if (this.userData) {
        this.sex = this.userData.sex;
        if( this.userData.user){
          this.habitData = this.userData.user
          .sort((a, b) => {
            return b.counts - a.counts;
          })
          .slice(0, 15);
        }
        
        this.drawSex();
        this.drawHabitChart();
        this.showTip();
        this.startAction();
      }
    },
    initChart(name, el) {
      this[name] = this.$echarts.init(this.$refs[el], "dark");
      this[name].showLoading({
        text: "加载中...",
        maskColor: "rgba(0, 0, 0, 0.3)",
        textColor: "#fff"
      });
    },
    drawHabitChart() {
      var datalist = [
        {
          offset: [56, 38],
          symbolSize: 60,
          opacity: 0.95,
          color: "#f467ce"
        },
        {
          offset: [15, 35],
          symbolSize: 55,
          opacity: 0.88,
          color: "#7aabe2"
        },
        {
          offset: [87, 33],
          symbolSize: 42,
          opacity: 0.84,
          fontSize: 38,
          color: "#FE5656"
        },
        {
          offset: [28, 85],
          symbolSize: 42,
          opacity: 0.9,
          fontSize: 16,
          color: "#FFAD05"
        },
        {
          offset: [37, 63],
          symbolSize: 38,
          opacity: 0.84,
          fontSize: 32,
          color: "#ff7123"
        },
        {
          offset: [3, 75],
          symbolSize: 37,
          opacity: 0.68,
          fontSize: 16,
          color: "#e76e07"
        },
        {
          offset: [38, 30],
          symbolSize: 34,
          opacity: 0.8,
          fontSize: 28,
          color: "#FFAD05"
        },
        {
          offset: [74, 40],
          symbolSize: 32,
          opacity: 0.7,
          fontSize: 20,
          color: "#3dba2d"
        },
        {
          offset: [75, 91],
          symbolSize: 30,
          opacity: 0.68,
          fontSize: 16,
          color: "#8a3647"
        },
        {
          offset: [82, 75],
          symbolSize: 28,
          opacity: 0.68,
          fontSize: 16,
          color: "#d0a00e"
        },
        {
          offset: [66, 80],
          symbolSize: 25,
          opacity: 0.75,
          fontSize: 24,
          color: "#5e333f"
        },

        {
          offset: [94, 62],
          symbolSize: 20,
          opacity: 0.6,
          fontSize: 12,
          color: "#e69d87"
        },
        {
          offset: [95, 85],
          symbolSize: 20,
          opacity: 0.68,
          fontSize: 16,
          color: "#FE5656"
        },
        {
          offset: [45, 85],
          symbolSize: 18,
          opacity: 0.68,
          fontSize: 16,
          color: "#906BF9"
        },
        {
          offset: [0, 35],
          symbolSize: 16,
          opacity: 0.68,
          fontSize: 16,
          color: "#FE5656"
        }
      ];
      var datas = [];
      for (var a = 0; a < this.habitData.length; a++) {
        var item =
          this.habitData[a].page_name + "\n" + this.habitData[a].counts;
        var itemToStyle = datalist[a];
        datas.push({
          name: item,
          value: itemToStyle.offset,
          symbolSize: itemToStyle.symbolSize,
          label: {
            normal: {
              textStyle: {
                fontSize: 8,
                color: "#fff"
              }
            }
          },
          itemStyle: {
            normal: {
              color: itemToStyle.color,
              opacity: itemToStyle.opacity
            }
          }
        });
      }
      let option = {
        grid: {
          show: false,
          top: 10,
          bottom: 10
        },
        xAxis: [
          {
            gridIndex: 0,
            type: "value",
            show: false,
            min: 0,
            max: 100,
            nameLocation: "middle",
            nameGap: 5
          }
        ],
        yAxis: [
          {
            gridIndex: 0,
            min: 0,
            show: false,
            max: 100,
            nameLocation: "middle",
            nameGap: 30
          }
        ],
        series: [
          {
            type: "scatter",
            symbol: "circle",
            symbolSize: 70,
            label: {
              normal: {
                show: true,
                formatter: "{b}",
                color: "#fff",
                textStyle: {
                  fontSize: "20"
                }
              },
              emphasis: {}
            },
            itemStyle: {
              normal: {
                borderWidth: "1",
                borderType: "solid",
                borderColor: "#54dcf2",
                color: "#68b837",
                shadowColor: "#1A47C6",
                shadowBlur: 8
              },
              emphasis: {
                borderColor: "#aaff00",
                color: "#ff401a",
                opacity: 1
              }
            },
            data: datas
          }
        ]
      };
      if( this.habitChart){
        this.habitChart.clear();
      }
      this.habitChart.setOption(option);
      this.habitChart.hideLoading();
    },
    drawSex() {
      var symbols = [
        "path://M18.2629891,11.7131596 L6.8091608,11.7131596 C1.6685112,11.7131596 0,13.032145 0,18.6237673 L0,34.9928467 C0,38.1719847 4.28388932,38.1719847 4.28388932,34.9928467 L4.65591984,20.0216948 L5.74941883,20.0216948 L5.74941883,61.000787 C5.74941883,65.2508314 11.5891201,65.1268798 11.5891201,61.000787 L11.9611506,37.2137775 L13.1110872,37.2137775 L13.4831177,61.000787 C13.4831177,65.1268798 19.3114787,65.2508314 19.3114787,61.000787 L19.3114787,20.0216948 L20.4162301,20.0216948 L20.7882606,34.9928467 C20.7882606,38.1719847 25.0721499,38.1719847 25.0721499,34.9928467 L25.0721499,18.6237673 C25.0721499,13.032145 23.4038145,11.7131596 18.2629891,11.7131596 M12.5361629,1.11022302e-13 C15.4784742,1.11022302e-13 17.8684539,2.38997966 17.8684539,5.33237894 C17.8684539,8.27469031 15.4784742,10.66467 12.5361629,10.66467 C9.59376358,10.66467 7.20378392,8.27469031 7.20378392,5.33237894 C7.20378392,2.38997966 9.59376358,1.11022302e-13 12.5361629,1.11022302e-13",
        "path://M28.9624207,31.5315864 L24.4142575,16.4793596 C23.5227152,13.8063773 20.8817445,11.7111088 17.0107398,11.7111088 L12.112691,11.7111088 C8.24168636,11.7111088 5.60080331,13.8064652 4.70917331,16.4793596 L0.149791395,31.5315864 C-0.786976655,34.7595013 2.9373074,35.9147532 3.9192135,32.890727 L8.72689855,19.1296485 L9.2799493,19.1296485 C9.2799493,19.1296485 2.95992025,43.7750224 2.70031069,44.6924335 C2.56498417,45.1567684 2.74553639,45.4852068 3.24205501,45.4852068 L8.704461,45.4852068 L8.704461,61.6700801 C8.704461,64.9659872 13.625035,64.9659872 13.625035,61.6700801 L13.625035,45.360657 L15.5097899,45.360657 L15.4984835,61.6700801 C15.4984835,64.9659872 20.4191451,64.9659872 20.4191451,61.6700801 L20.4191451,45.4852068 L25.8814635,45.4852068 C26.3667633,45.4852068 26.5586219,45.1567684 26.4345142,44.6924335 C26.1636859,43.7750224 19.8436568,19.1296485 19.8436568,19.1296485 L20.3966199,19.1296485 L25.2043926,32.890727 C26.1862111,35.9147532 29.9105828,34.7595013 28.9625083,31.5315864 L28.9624207,31.5315864 Z M14.5617154,0 C17.4960397,0 19.8773132,2.3898427 19.8773132,5.33453001 C19.8773132,8.27930527 17.4960397,10.66906 14.5617154,10.66906 C11.6274788,10.66906 9.24611767,8.27930527 9.24611767,5.33453001 C9.24611767,2.3898427 11.6274788,0 14.5617154,0 L14.5617154,0 Z",
        "path://M512 292.205897c80.855572 0 146.358821-65.503248 146.358821-146.358821C658.358821 65.503248 592.855572 0 512 0 431.144428 0 365.641179 65.503248 365.641179 146.358821 365.641179 227.214393 431.144428 292.205897 512 292.205897zM512 731.282359c-80.855572 0-146.358821 65.503248-146.358821 146.358821 0 80.855572 65.503248 146.358821 146.358821 146.358821 80.855572 0 146.358821-65.503248 146.358821-146.358821C658.358821 796.273863 592.855572 731.282359 512 731.282359z",
        "path://M180.769,664.434L180.769,664.434c-55.428,0-100.362-44.934-100.362-100.367 c0-55.429,44.934-100.363,100.362-100.363 M180.769,494.588L180.769,494.588c-38.374,0-69.479,31.109-69.479,69.48 c0,38.374,31.104,69.483,69.479,69.483 M180.769,494.588 M844.713,463.704c55.428,0,100.362,44.934,100.362,100.363c-0.062,55.404-44.958,100.305-100.362,100.367 l0,0 M844.713,633.551c38.37,0,69.478-31.109,69.478-69.483c-0.042-38.356-31.123-69.437-69.478-69.48l0,0 M844.713,494.588 M189.68,418.316 M189.68,419.072v0.175l-1.187,163.079c0,190.971,145.475,346.342,324.245,346.342 c178.777,0,324.251-155.371,324.251-346.342l-1.234-163.254l30.874,0.019l1.244,163.131c0.122,50.179-9.307,99.929-27.782,146.588 c-17.51,44.388-43.262,85.066-75.894,119.884c-31.9,34.224-70.279,61.78-112.905,81.061 c-43.535,19.691-90.773,29.851-138.554,29.789l0,0c-47.785,0.062-95.028-10.098-138.567-29.799 c-42.629-19.286-81.005-46.838-112.905-81.061c-32.626-34.817-58.369-75.492-75.874-119.875 c-18.475-46.659-27.905-96.409-27.782-146.588v-0.117l1.234-163.09 M188.493,582.326 M852.431,480.894c-6.442,0.005-12.214-3.986-14.475-10.017l-42.781-114.145 c-22.986-2.182-77.914-11.879-127.38-54.873c-34.573,34.62-77.16,60.168-123.98,74.376 c-41.494,12.726-87.422,17.368-136.385,13.905c-46.631-3.483-92.555-13.415-136.456-29.512l-85.572,114.088 c-3.987,5.316-10.928,7.483-17.232,5.381c-6.305-2.101-10.56-8.001-10.56-14.644c0-54.533,2.304-95.306,7.487-132.211 c5.791-41.127,15.163-76.142,28.607-106.53c-20.964-15.305-35.614-34.181-43.644-56.272c-7.893-21.689-7.893-42.479-7.893-56.258 c0.005-6.125,3.624-11.667,9.227-14.13c5.602-2.464,12.133-1.386,16.647,2.752c39.807,36.466,99.001,17.237,151.432-3.765 C370.882,75.465,434.08,64,512.738,64c146.475,0,244.156,40.811,298.604,124.77c49.679,76.594,56.53,178.248,56.53,276.684 c-0.005,7.463-5.344,13.858-12.69,15.186C854.273,480.81,853.355,480.894,852.431,480.894L852.431,480.894z M174.978,144.095 c3.68,21.167,14.475,44.694,46.4,64.014c6.875,4.175,9.391,12.921,5.791,20.111c-27.448,54.843-35.783,123.86-37.974,189.947 l64.144-85.504c4.298-5.73,11.974-7.751,18.538-4.882c0.589,0.259,61.002,26.242,138.657,31.623c102.195,7.077,184.689-23.08,245.188-89.619c2.836-3.124,6.832-4.948,11.054-5.052c4.222-0.099,8.298,1.532,11.285,4.519 c56.201,56.191,127.381,57.237,128.051,57.237c6.437,0.01,12.194,3.996,14.475,10.013l13.075,34.879 c-5.263-61.299-18.112-119.385-48.223-165.803C737.117,131.09,647.923,94.882,512.738,94.882 c-73.253,0-134.049,10.895-180.697,32.396l-0.726,0.306c-29.366,11.775-60.866,23.065-92.229,25.968 C215.068,155.786,193.605,152.601,174.978,144.095L174.978,144.095z M759.787,511.773h-27.24 c-8.788-9.82-21.341-15.432-34.52-15.432c-13.18,0-25.732,5.612-34.52,15.432h-27.24c-8.53,0-15.442,6.912-15.442,15.442 c0,8.529,6.912,15.442,15.442,15.442h15.442c0,25.582,20.737,46.319,46.319,46.319s46.319-20.737,46.319-46.319h15.442 c8.53,0,15.442-6.913,15.442-15.442C775.228,518.685,768.316,511.773,759.787,511.773L759.787,511.773z M389.217,511.773h-27.245 c-8.783-9.82-21.34-15.432-34.516-15.432c-13.18,0-25.733,5.612-34.52,15.432h-27.24c-8.53,0-15.442,6.912-15.442,15.442 c0,8.529,6.912,15.442,15.442,15.442h15.436c0,25.582,20.743,46.319,46.325,46.319c25.582,0,46.319-20.737,46.319-46.319h15.442 c8.528,0,15.442-6.913,15.442-15.442C404.658,518.685,397.745,511.773,389.217,511.773L389.217,511.773z M512.738,836.024 c-84.176,0-127.16-15.748-128.945-16.408c-7.996-2.978-12.058-11.878-9.076-19.87c2.983-7.996,11.88-12.059,19.876-9.081 c0.598,0.227,40.463,14.475,118.145,14.475c77.891,0,117.736-14.33,118.151-14.475c7.996-2.978,16.893,1.084,19.875,9.081 c2.983,7.992-1.083,16.892-9.075,19.87C639.902,820.276,596.92,836.024,512.738,836.024L512.738,836.024z M512.738,836.024",
        "path://M882.704,450.268c8.524,0,15.437,6.913,15.437,15.443v478.695c0,8.526-6.912,15.438-15.437,15.438l0,0 H141.495c-8.529,0-15.443-6.913-15.443-15.438V465.711c0-8.53,6.914-15.443,15.443-15.443l15.443,30.885v447.812h710.323V481.152 L882.704,450.268z M156.938,928.964 M180.099,494.847L180.099,494.847c-38.378,0-69.484,31.112-69.484,69.486 c0,38.378,31.107,69.489,69.484,69.489v30.886l0,0c-55.432,0-100.37-44.938-100.37-100.375 c0-55.434,44.938-100.372,100.37-100.372V494.847 M180.099,494.847 M844.1,463.961c55.432,0,100.37,44.938,100.37,100.372c-0.062,55.408-44.962,100.314-100.37,100.375l0,0 M844.1,633.822c38.373,0,69.484-31.112,69.484-69.489c-0.042-38.359-31.126-69.443-69.484-69.486l0,0 M844.1,494.847 M512.096,959.844c-47.789,0.062-95.036-10.099-138.579-29.801 c-42.633-19.288-81.011-46.842-112.914-81.068c-32.629-34.82-58.374-75.498-75.881-119.885 c-18.477-46.663-28.907-96.417-28.784-146.6v-0.117l1.234-163.443l1-0.297c0.156-3.303,4.247-81.832,49.656-161.359 c26.898-47.096,62.732-84.66,106.464-111.653c54.382-33.51,120.936-50.513,197.804-50.513c76.875,0,143.429,17.003,197.848,50.551 c43.751,27.021,79.566,64.555,106.464,111.651c45.358,79.528,49.501,158.056,49.656,161.359l1,0.598l1.197,163.221 c0.122,50.183-10.307,99.937-28.784,146.6c-17.512,44.392-43.266,85.073-75.9,119.895 c-31.903,34.227-70.285,61.785-112.914,81.068C607.124,949.745,559.881,959.906,512.096,959.844L512.096,959.844z M187.824,582.593c0,190.987,145.487,346.371,324.273,346.371c178.792,0,325.279-155.384,325.279-346.371l-1.224-162.725 c-0.288-4.826-6.297-77.209-47.174-148.222c-55.635-96.647-148.801-145.657-276.881-145.657s-221.24,49.01-276.88,145.657 c-40.871,71.013-46.881,143.396-47.169,148.222L187.824,582.593z M186.824,582.593 M882.704,465.711 M844.311,483.08c-32.883-0.047-65.677-3.397-97.891-10c-45.273-9.255-87.449-24.745-125.343-45.974 c-41.606-23.336-78.552-54.151-108.98-90.894c-30.423,36.743-67.368,67.558-108.98,90.894 c-37.888,21.281-80.102,36.771-125.337,46.054c-76.95,15.787-135.86,8.234-138.32,7.903c-7.691-1.023-13.431-7.597-13.408-15.353 c0-56.819,9.289-110.564,27.596-159.748c18.087-48.581,44.5-91.474,78.491-127.463c34.35-36.37,76.022-65.041,122.27-84.117 c48.142-20.019,101.19-30.16,157.687-30.16s109.551,10.141,157.693,30.16c46.248,19.075,87.92,47.746,122.27,84.117 c33.991,35.989,60.404,78.882,78.49,127.463c18.337,49.221,27.591,102.929,27.591,159.748c0,7.738-5.73,14.282-13.402,15.305 C883.523,481.152,868.495,483.08,844.311,483.08L844.311,483.08z M157.14,451.531c38.723,1.978,77.535-1.009,115.492-8.889 c95.606-19.854,172.024-67.161,227.112-140.614c2.917-3.888,7.493-6.178,12.351-6.178c4.864,0,9.44,2.29,12.357,6.178 c55.089,73.453,131.505,120.761,227.116,140.614c37.959,7.89,76.771,10.877,115.489,8.889 C860.861,240.925,716.702,95.108,512.096,95.108C307.496,95.108,163.338,240.935,157.14,451.531L157.14,451.531z M157.14,451.531 M359.555,503.764l-12.789,12.789c-1.475-0.707-2.983-1.328-4.524-1.876v-18.086 c0-8.524-6.914-15.438-15.443-15.438c-8.53,0-15.443,6.914-15.443,15.438v18.086c-1.541,0.548-3.053,1.169-4.529,1.876 l-12.785-12.789c-6.032-6.032-15.81-6.032-21.842,0c-6.032,6.032-6.032,15.81,0,21.842l12.79,12.785 c-9.294,19.471-3.917,42.775,12.969,56.206c16.88,13.43,40.795,13.43,57.68,0c16.88-13.431,22.257-36.735,12.969-56.206 l12.785-12.785c6.032-6.032,6.032-15.81,0-21.842C375.365,497.732,365.586,497.732,359.555,503.764L359.555,503.764z M751.999,503.764c-2.899-2.899-6.828-4.524-10.924-4.524c-4.094,0-8.025,1.625-10.919,4.524l-12.789,12.789 c-1.475-0.707-2.983-1.328-4.524-1.876v-18.086c0-8.524-6.914-15.438-15.443-15.438c-8.529,0-15.443,6.914-15.443,15.438v18.086 c-1.541,0.548-3.049,1.169-4.524,1.876l-12.789-12.789c-3.903-3.903-9.586-5.425-14.916-3.997 c-5.33,1.428-9.495,5.589-10.923,10.919c-1.428,5.33,0.099,11.018,3.996,14.919l12.79,12.785 c-9.293,19.471-3.911,42.775,12.969,56.206c16.88,13.43,40.8,13.43,57.68,0c16.88-13.431,22.261-36.735,12.969-56.206 l12.79-12.785c2.893-2.898,4.524-6.823,4.524-10.924C756.523,510.587,754.892,506.662,751.999,503.764L751.999,503.764z M512.096,836.312c-64.659,0-98.16-16.409-99.56-17.074c-7.639-3.793-10.754-13.063-6.956-20.702 c3.794-7.639,13.064-10.754,20.703-6.955c0.673,0.334,29.608,13.845,85.813,13.845c56.606,0,85.55-13.713,85.829-13.845 c7.62-3.69,16.791-0.551,20.556,7.031s0.721,16.781-6.818,20.626C610.263,819.903,576.761,836.312,512.096,836.312 L512.096,836.312z M512.096,836.312",
        "path://M865.146,412.276c-39.292-133.974-151.008-234.178-288.449-258.721 c-33.165-14.793-70.397-17.767-105.486-8.432c-8.247,2.177-16.302,4.999-24.1,8.452c-137.367,24.636-249.01,124.8-288.347,258.701 C105.118,417.052,64,461.997,64,515.853c0,53.856,41.118,98.803,94.764,103.577c46.03,156.731,189.843,264.38,353.188,264.38 c163.352,0,307.158-107.649,353.193-264.38c53.641-4.774,94.766-49.721,94.766-103.577 C959.911,461.997,918.787,417.052,865.146,412.276L865.146,412.276z M567.299,184.45c3.08,1.494,6.117,3.105,9.11,4.838 c44.711,26.086,69.313,76.534,62.327,127.828c-6.987,51.293-44.185,93.323-94.247,106.497 c-61.473,16.179-124.474-15.41-149.52-71.741c2.812,1.494,5.692,2.851,8.637,4.067c21.004,8.823,44.34,10.429,66.355,4.569 c55.473-14.671,88.618-71.466,74.098-126.982c-5.429-21.029-17.367-39.8-34.102-53.636c-0.811-0.66-1.611-1.329-2.432-1.997 c-2.518-1.962-5.126-3.803-7.82-5.532C522.919,170.097,546.31,174.28,567.299,184.45L567.299,184.45z M95.999,515.853 c0.044-33.043,22.546-61.833,54.608-69.85c-8.813,46.151-8.813,93.553,0,139.701C118.545,577.688,96.043,548.902,95.999,515.853 L95.999,515.853z M511.953,851.817c-149.983,0-277.288-98.778-320.344-234.685c-3.203-10.116-5.932-20.453-8.188-30.993 c-9.906-46.352-9.906-94.277,0-140.629c2.241-10.501,4.969-20.838,8.188-30.993C227.717,300.526,323.097,212.7,441.384,187.301 c1.28,0.366,2.602,0.561,3.936,0.591c34.546,0.879,63.592,26.183,69.201,60.286c5.609,34.099-13.802,67.371-46.245,79.269 c-32.448,11.904-68.766-0.927-86.538-30.568c-3.75-6.273-11.274-9.203-18.279-7.128c-7.007,2.08-11.712,8.642-11.435,15.946 c0.455,11.751,2.187,23.42,5.176,34.796c18.494,70.187,81.871,119.165,154.455,119.367c13.836-0.005,27.614-1.797,40.997-5.327 c85.308-22.459,136.455-110.12,113.986-195.428c-5.009-19.138-13.529-37.183-25.12-53.216 c91.06,38.297,160.778,114.558,190.78,208.678c3.212,10.116,5.942,20.453,8.188,30.998c9.906,46.352,9.906,94.272,0,140.624 c-2.236,10.506-4.966,20.838-8.188,30.998C789.242,753.039,661.936,851.817,511.953,851.817L511.953,851.817z M873.305,585.704 c8.812-46.147,8.812-93.55,0-139.701c32.066,7.997,54.569,36.802,54.569,69.85C927.874,548.902,905.371,577.708,873.305,585.704 L873.305,585.704z M873.305,585.704 M515.962,519.725c-27.216,0-48.548,7.721-63.995,23.538c-15.446,15.447-23.171,36.412-23.171,63.259h38.618 c0-16.185,3.309-28.689,9.932-37.514c7.353-10.667,19.491-15.817,36.044-15.817c13.24,0,23.906,3.68,31.26,11.034 c6.989,7.358,10.667,17.288,10.667,30.161c0,9.561-3.678,18.389-10.299,26.848l-6.251,6.987 c-22.804,20.229-36.779,35.308-41.562,45.607c-5.148,9.563-7.353,21.333-7.353,34.94v6.252h39.353v-6.252 c0-8.827,1.838-16.917,5.883-24.274c3.312-6.622,8.46-13.24,15.449-19.126c17.285-15.079,27.583-24.642,30.892-28.686 c9.196-11.77,13.976-26.848,13.976-44.872c0-22.065-7.354-39.721-22.065-52.593C558.628,525.975,539.501,519.725,515.962,519.725 L515.962,519.725z M509.343,734.88c-7.357,0-13.978,2.206-19.126,7.354c-5.148,4.783-7.725,11.037-7.725,18.759 c0,7.353,2.577,13.607,7.725,18.759c5.15,5.148,11.769,7.722,19.123,7.722c7.358,0,13.979-2.574,19.127-7.354 c5.15-5.151,8.092-11.402,8.092-19.126c0-7.725-2.574-13.976-7.724-18.755C523.687,737.086,517.065,734.88,509.343,734.88 L509.343,734.88z M509.343,734.88"
      ];
      let data = {};
      let bodyMax = this.sex.dataList.reduce((a, b) => {
        //指定图形界限的值
        return a + b;
      });
      this.sex.sexName.forEach((item, index) => {
        data[item] = this.sex.dataList[index];
      });

      var labelSetting = {
        normal: {
          show: false,
          position: "bottom",
          offset: [0, -20],
          formatter: function(param) {
            return param.value + "人";
          },
          textStyle: {
            fontSize: 8,
            fontFamily: "Arial",
            color: "#fff"
          }
        }
      };

      let option = {
        tooltip: {
          show: false //鼠标放上去显示悬浮数据
        },
        legend: {
          data: ["男", "女", "未知"],
          selectedMode: "single",
          itemWidth: 3, //图例的宽度
          itemHeight: 3, //图例的高度
          itemGap: 3,
          orient: "horizontal",
          left: "center",
          top: "20px",
          icon: "circle",
          // selectedMode: false, //取消图例上的点击事件
          textStyle: {
            color: "#808492"
          }
        },
        grid: {
          top: "10%",
          bottom: "20%",
          containLabel: true
        },
        xAxis: {
          data: ["a", "x","a", "b", "x","b","d","x","d"],
          axisTick: {
            show: false
          },
          axisLine: {
            show: false
          },
          axisLabel: {
            show: false,
            fontSize: 6
          }
        },
        yAxis: {
          max: bodyMax,
          splitLine: {
            show: false
          },
          axisTick: {
            // 刻度线
            show: false
          },
          axisLine: {
            // 轴线
            show: false
          },
          axisLabel: {
            // 轴坐标文字
            show: false,
            fontSize: 6
          }
        },
        series: [
          {
            type: "pictorialBar",
            symbolClip: true,
            symbolBoundingData: bodyMax,
            label: labelSetting,
            data: [
              {
                value: data["男"],
                symbol: symbols[3],
                itemStyle: {
                  normal: {
                    color: "rgba(42,201,253)" //单独控制颜色
                  }
                }
              },
              {},
              {
                type: "line",
                value: data["男"],
                itemStyle:{
                  color:"transparent"
                },
                label:{
                  show:true,
                  padding:[2,10,0,0] 

                }
              },
              {
                value: data["女"],
                symbol: symbols[4],
                itemStyle: {
                  normal: {
                    color: "rgba(193,46,52)" //单独控制颜色
                  }
                }
              },
              {},
              {
                type: "line",
                value: data["女"],
                 itemStyle:{
                  color:"transparent"
                },
                label:{
                  show:true, 
                  padding:[2,10,0,0] 
                }
              },
              {
                value: data["未知"],
                symbol: symbols[5],
                itemStyle: {
                  normal: {
                    color: "rgba(230,110,7)" //单独控制颜色
                  }
                }
              },
              {},
              {
                type: "line",
                value: data["未知"],
                 itemStyle:{
                  color:"transparent"
                },
                label:{
                  show:true,
                  padding:[2,2,0,0]
                }
              }
            ],
            // markLine: markLineSetting,
            z: 10
          },

          {
            // 设置背景底色，不同的情况用这个
            name: "full",
            type: "pictorialBar", //异型柱状图 图片、SVG PathData
            symbolBoundingData: bodyMax,
            animationDuration: 0,
            itemStyle: {
              normal: {
                color: "#ccc" //设置全部颜色，统一设置
              }
            },
            z: 10,
            data: [
              {
                itemStyle: {
                  normal: {
                    color: "rgba(42,201,253,0.40)" //单独控制颜色
                  }
                },
                value: 100,
                symbol: symbols[3],
              },
              {
                // 设置中间冒号
                itemStyle: {
                  normal: {
                    color: "#1DA1F2" //单独控制颜色
                  }
                },
                value: 100,
                symbol: symbols[2],
                symbolSize: [8, "18%"],
                symbolOffset: [0, "-200%"]
              },
              {},
              {
                itemStyle: {
                  normal: {
                    color: "rgba(193,46,52,0.40)" //单独控制颜色
                  }
                },
                value: 100,
                symbol: symbols[4]
              },
              {
                // 设置中间冒号
                itemStyle: {
                  normal: {
                    color: "#1DA1F2" //单独控制颜色
                  }
                },
                value: 100,
                symbol: symbols[2],
                symbolSize: [8, "18%"],
                symbolOffset: [0, "-200%"]
              },
              {},
              {
                itemStyle: {
                  normal: {
                    color: "rgba(230,110,7,0.40)" //单独控制颜色
                  }
                },
                value: 100,
                symbol: symbols[5]
              },
              {
                // 设置中间冒号
                itemStyle: {
                  normal: {
                    color: "#1DA1F2" //单独控制颜色
                  }
                },
                value: 100,
                symbol: symbols[2],
                symbolSize: [8, "18%"],
                symbolOffset: [0, "-200%"]
              },
              {}
            ]
          }
        ]
      };
      if( this.sexChart){
        this.sexChart.clear();
      }
      this.sexChart.hideLoading();
      this.sexChart.setOption(option);
    },
    showTip() {
      if (this.isLunbo) {
        if (this.indexItem >= this.habitData.length) {
          this.indexItem = 0;
        }
        this.habitChart.dispatchAction({
          type: "downplay",
          seriesIndex: 0
        });
        this.habitChart.dispatchAction({
          type: "highlight",
          seriesIndex: 0,
          dataIndex: this.indexItem
        });
        this.indexItem++;
      }
    },
    startAction() {
      if(this.timer){
        clearInterval(this.timer);
      }
      if (this.isLunbo) {
        this.timer = setInterval(() => {
          this.showTip();
        }, this.lbTime);
      } else {
        clearInterval(this.timer);
      }
    }
  },
  mounted() {
    this.initChart("sexChart", "sexDom");
    this.initChart("habitChart", "habitDom");
    this.hasData();
    this.$er.listenTo(this.$refs.sexDom, el => {
      let height = el.offsetHeight;
      let width = el.offsetWidth;
      let height1 = this.$refs.habitDom.offsetHeight;
      this.$nextTick(() => {
        this.sexChart.resize({ width: width, height: height });
        this.habitChart.resize({ width: width, height: height1 });
      });
    });
  },
  beforeDestroy() {
    clearInterval(this.timer);
  }
};
</script>

<style scoped lang="scss">
.header {
  height: 80px;
  width: 100%;
  padding-top: 13px;
  font-size: 36px;
  color: #00ffff;
  text-align: center;
  background: url(../assets/images/top_bg.png) bottom center no-repeat;
  background-size: cover;
}
.clearfix {
  display: block;
  &::before,
  &::after {
    clear: both;
    display: block;
    contain: " ";
  }
}
</style>


